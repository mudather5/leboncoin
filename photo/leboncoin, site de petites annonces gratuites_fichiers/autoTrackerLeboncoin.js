/* SPT */!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.AutoTrack=e():t.AutoTrack=e()}(this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=77)}([function(t,e,n){"use strict";function i(t,e,n){var i,r=1;if(!t||"number"!=typeof t)throw new Error("times required");if(!e||"function"!=typeof e)throw new Error("task required");if(!n||"function"!=typeof n)throw new Error("callback required");i=function(){arguments[0]&&r>=t?n.apply(null,arguments):arguments[0]?(r+=1,e(i)):n.apply(null,arguments)},e(i)}function r(){var t,e;return"undefined"!=typeof window.innerWidth?(t=window.innerWidth,e=window.innerHeight):"undefined"!=typeof document.documentElement.clientWidth&&0!==document.documentElement.clientWidth?(t=document.documentElement.clientWidth,e=document.documentElement.clientHeight):(t=document.getElementsByTagName("body")[0].clientWidth,e=document.getElementsByTagName("body")[0].clientHeight),t+"x"+e}function o(){var t;return navigator.userLanguage?t=navigator.userLanguage:navigator.language&&(t=navigator.language),t}function s(t){var e={mobile:["iPhone;","iPod;","iPod touch;","^HTC","Fennec","IEMobile","BB10;","BlackBerry","SymbianOS.*AppleWebKit","^Mozilla.*Mobile.*Firefox","^Mozilla.*Chrome.*Mobile","Opera Mobi","Android.*Mobile","Android.*Mini","Symbian","^SonyEricsson","^Nokia","^SAMSUNG","^LG"],tablet:["iPad;","Android"]},n=function(e){var n,i=0;for(i;i<e.length;i++)if(n=e[i],t.match(new RegExp(n)))return!0;return!1};if(t){if(n(e.mobile))return"mobile";if(n(e.tablet))return"tablet"}return"desktop"}function a(){var t=new Date,e=-t.getTimezoneOffset(),n=e>=0?"+":"-",i=function(t){var e=Math.abs(Math.floor(t));return(e<10?"0":"")+e},r=t.getFullYear()+"-"+i(t.getMonth()+1)+"-"+i(t.getDate());return r=r+"T"+i(t.getHours())+":"+i(t.getMinutes()),r=r+":"+i(t.getSeconds()),r=r+n+i(e/60)+":"+i(e%60)}function c(){var t,e,n="",i=function(){return window.crypto?window.crypto.getRandomValues(new Uint8Array(1))[0]/256:Math.random()};for(e=0;e<36;e++)t=14===e?4:19===e?Math.floor(4*i()+8).toString(16):8===e||13===e||18===e||23===e?"-":Math.floor(16*i()).toString(16),n+=t;return n}function u(t){var e,n,i=[],r=location.search,o=r.split("&"),s=new RegExp(t+"=([^&;]+?)(&|#|;|$)","i");for(n=0;n<o.length;n++)e=o[n].match(s),e&&i.push(e[1]);return i}function d(){return(Math.floor(window.pageYOffset)||document.scrollTop||0)-(document.clientTop||0)}function p(){var t,e,n;if(!window.performance)return null;t=window.performance.timing.domLoading,e=(new Date).getTime();try{n=e-t}catch(t){n=null}return n}function h(){localStorage.setItem("pulse2-val","check"),localStorage.removeItem("pulse2-val")}function l(t){return"[object Array]"===Object.prototype.toString.call(t)}function f(t){var e,n,i=Object.prototype.hasOwnProperty,r=!{toString:null}.propertyIsEnumerable("toString"),o=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],s=o.length,a=[];if("object"!==("undefined"==typeof t?"undefined":x(t))&&("function"!=typeof t||null===t))throw new TypeError("Object.keys called on non-object");for(e in t)i.call(t,e)&&a.push(e);if(r)for(n=0;n<s;n++)i.call(t,o[n])&&a.push(o[n]);return a}function y(){return(new Date).getTime()}function g(t){var e=decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(t).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||!1;return e}function v(t,e){var n=t+"=";e&&(n+=";domain="+e,n+=";path=/"),n+=";expires=Thu, 01 Jan 1970 00:00:01 GMT",document.cookie=n}function m(t,e,n,i){var r;r=t+"="+e,r+=";domain="+n,r+=";path=/",r+=";expires="+i,document.cookie=r}function b(t){return"m.finn.no"===t?"finn.no":t.replace(/^www\./,"")}function j(t,e,n){t.addEventListener?t.addEventListener(e,n):t.attachEvent("on"+e,n)}function I(t,e,n){t.removeEventListener?t.removeEventListener(e,n):t.detachEvent("on"+e,n)}function k(t){return"string"==typeof t&&t.indexOf("sdrn:")===-1?t.replace(/:/g,"%3A"):t}function w(t){return t&&"string"==typeof t?"ClassifiedAd"===t?"classified":"NotificationContent"===t?"notification":t.toLowerCase():t}function S(t,e,n){var i=k(n),r=w(k(e));if(t=k(t),0===String(t).indexOf("sdrn:"))return t;if(!t)throw new Error("`clientId` is required");if(!e)throw new Error("`contentType` is required");if(!n)throw new Error("`targetId` is required");return"sdrn:"+t+":"+r+":"+i}function O(t){return t<10?"0"+t:t}function T(t){return t.getUTCFullYear()+"-"+O(t.getUTCMonth()+1)+"-"+O(t.getUTCDate())+"T"+O(t.getUTCHours())+":"+O(t.getUTCMinutes())+":"+O(t.getUTCSeconds())+"."+(t.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}function E(t){var e=document.createElement("a");return e.setAttribute("href",t),e.hostname}function C(t,e,n){if(!t[e])throw new Error((n||e)+" is required")}Object.defineProperty(e,"__esModule",{value:!0});var x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.retry=i,e.getViewportDimensions=r,e.getDeviceLanguage=o,e.getDeviceType=s,e.getTimestamp=a,e.getUuidV4=c,e.getUrlParams=u,e.getScrollPosition=d,e.getViewDuration=p,e.checkLocalStorage=h,e.isArray=l,e.objectKeys=f,e.dateNow=y,e.getCookie=g,e.deleteCookie=v,e.writeCookie=m,e.broadenDomain=b,e.bind=j,e.unbind=I,e.getSdrnIdWithContentType=S,e.dateToISO=T,e.getDomainFromUrl=E,e.requiredAttribute=C},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(e?console.log:a)(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.debug=r;var o=n(37),s=i(o),a=(0,s.default)("spt:pulse")},function(t,e){var n=t.exports={version:"2.4.0"};"number"==typeof __e&&(__e=n)},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,n){var i=n(3),r=n(2),o=n(18),s=n(68),a=n(15),c="prototype",u=function(t,e,n){var d,p,h,l,f=t&u.F,y=t&u.G,g=t&u.S,v=t&u.P,m=t&u.B,b=y?i:g?i[e]||(i[e]={}):(i[e]||{})[c],j=y?r:r[e]||(r[e]={}),I=j[c]||(j[c]={});y&&(n=e);for(d in n)p=!f&&b&&void 0!==b[d],h=(p?b:n)[d],l=m&&p?a(h,i):v&&"function"==typeof h?a(Function.call,h):h,b&&s(b,d,h,t&u.U),j[d]!=h&&o(j,d,l),v&&I[d]!=h&&(I[d]=h)};i.core=r,u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,t.exports=u},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(43);Object.keys(i).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(e,t,{enumerable:!0,get:function(){return i[t]}})})},function(t,e,n){"use strict";function i(){}Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=n(0);i.prototype.getUrlWithCorrectProtocol=function(t){var e=t.split("://");return"//"+e.pop()},i.prototype.getXHR=function(t,e,n){var i;return"undefined"!=typeof XDomainRequest?(i=new XDomainRequest,i.open(e.toLowerCase(),this.getUrlWithCorrectProtocol(n)),i):(i=new XMLHttpRequest,"withCredentials"in i&&(i.open(e,n),i.setRequestHeader("Content-Type","application/json; charset=utf-8"),i.setRequestHeader("X-Requested-With","XMLHttpRequest"),t&&(i.withCredentials=!0),i))},i.prototype.addDataToUrl=function(t,e){var n,i;if(!e||"object"!==("undefined"==typeof e?"undefined":r(e)))return t;for(n=(0,o.objectKeys)(e);n&&"object"===r(e[n[0]]);)n.shift();for(t=this.appendParameterToUrl(t,n[0],e[n[0]],"?"),i=1;i<n.length;i++)t=this.appendParameterToUrl(t,n[i],e[n[i]],"&");return t},i.prototype.appendParameterToUrl=function(t,e,n,i){return"object"!==("undefined"==typeof n?"undefined":r(n))?t+i+encodeURIComponent(e)+"="+encodeURIComponent(n):t},i.prototype.post=function(t,e,n,i,o){return t?e&&"object"===("undefined"==typeof e?"undefined":r(e))?(i=i||!1,void this.send(t,e,n,i,o,"POST")):n("data required"):n("url required")},i.prototype.get=function(t,e,n,i,r){return t?(e&&(t=this.addDataToUrl(t,e)),void this.send(t,e,n,r,i,"GET")):n("url required")},i.prototype.send=function(t,e,n,i,r,s){var a=this;if(!n)throw new Error("callback required");r=r||3,(0,o.retry)(r,function(n){var r=a.getXHR(i,s,t);if(r||n("Failed to identify request method"),"undefined"!=typeof XDomainRequest?(r.onload=function(){n(null,r)},r.onprogress=function(){},r.onerror=function(){n("Failed request"),r.abort()},r.ontimeout=r.onerror):r.onreadystatechange=function(){4===r.readyState&&(200===r.status?n(null,r):n("Failed with status "+r.status))},"POST"===s)try{r.send(JSON.stringify(e))}catch(t){n(t.name+": "+t.message)}else if("GET"===s)try{r.send()}catch(t){n(t)}},n)},e.default=i},function(t,e,n){t.exports=!n(6)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,n){var i=n(14);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==i(t)?t.split(""):Object(t)}},function(t,e){var n=0,i=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+i).toString(36))}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){var i=n(15),r=n(10),o=n(24),s=n(23),a=n(54);t.exports=function(t,e){var n=1==t,c=2==t,u=3==t,d=4==t,p=6==t,h=5==t||p,l=e||a;return function(e,a,f){for(var y,g,v=o(e),m=r(v),b=i(a,f,3),j=s(m.length),I=0,k=n?l(e,j):c?l(e,0):void 0;j>I;I++)if((h||I in m)&&(y=m[I],g=b(y,I,v),t))if(n)k[I]=g;else if(g)switch(t){case 3:return!0;case 5:return y;case 6:return I;case 2:k.push(y)}else if(d)return!1;return p?-1:u||d?d:k}}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e,n){var i=n(12);t.exports=function(t,e,n){if(i(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var i=n(62),r=n(67);t.exports=n(9)?function(t,e,n){return i.f(t,e,r(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var i=n(3),r="__core-js_shared__",o=i[r]||(i[r]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,e,n){var i=n(6);t.exports=function(t,e){return!!t&&i(function(){e?t.call(null,function(){},1):t.call(null)})}},function(t,e){var n=Math.ceil,i=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?i:n)(t)}},function(t,e,n){var i=n(10),r=n(16);t.exports=function(t){return i(r(t))}},function(t,e,n){var i=n(21),r=Math.min;t.exports=function(t){return t>0?r(i(t),9007199254740991):0}},function(t,e,n){var i=n(16);t.exports=function(t){return Object(i(t))}},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function o(t){t=t||{},t.pageUnload===!0&&(M.queue.loadFromLocalStorage(),(0,y.pageUnload)(M)),t.hashChange===!0&&(0,y.hashChange)(M),t.engagementTime===!0&&(0,w.default)(M,t.engageOpts),t.impressionTracking===!0&&(0,O.default)(M,t.engageOpts),t.articleEngage===!0&&(M.engage=(0,E.default)(M,t.engageOpts)),t.pageEngage===!0&&(M.engage=(0,x.default)(M,t.engageOpts)),t.engagement===!0&&v.engagement(M),t.clickButton===!0&&f.button(M),t.pageLoad!==!1&&(0,y.pageLoad)(M)}function s(t){U!==!0&&(U=!0,o(t.trackingFeatures),b.impliedEvents(M))}function a(){try{for(var t,e=null,n=null;e=_.shift();){t=M;try{for(;n=e.shift();)if(n instanceof Array){var i=n[0],r=n.slice(1);t=t[i].apply(t,r)}else"string"==typeof n&&(t=t[n])}catch(t){(0,P.debug)("track.js: Pulse2 call queue execution failed: "+t,M.opts.debugMode)}}}catch(t){(0,P.debug)("track.js: Pulse2 call queue execution failed: "+t,M.opts.debugMode)}}function c(t,e){var n=t.throttle||1;if(e===!0&&(U=!1),Math.random()<n)return M&&M.engage&&M.engage.destroy&&M.engage.destroy(),M=new I.default(t),"complete"===document.readyState||"interactive"===document.readyState?s(t):(window.addEventListener("DOMContentLoaded",function(){s(t)},!1),window.addEventListener("load",function(){s(t)},!1)),setTimeout(a,10),_.push=function(){return Array.prototype.push.apply(this,arguments),setTimeout(a,1),this.length},M.getPageViewId()}function u(){return M.getPageViewId()}function d(){M.userLogout()}function p(t){M.userLogin(t)}function h(){return M}Object.defineProperty(e,"__esModule",{value:!0}),e.callQueue=void 0,e.initTracking=c,e.getPageViewId=u,e.logoutEvent=d,e.loginEvent=p,e.activity=h;var l=n(28),f=r(l),y=n(34),g=n(30),v=r(g),m=n(31),b=r(m),j=n(35),I=i(j),k=n(29),w=i(k),S=n(32),O=i(S),T=n(27),E=i(T),C=n(33),x=i(C),P=n(1),M={},U=!1,_=(window.AutoTrack||{}).callQueue||[];e.callQueue=_},function(t,e,n){"use strict";function i(t){var e=new Image,n=t.url+"?r="+Math.random();t.userId&&(n+="&id="+t.userId),e.src=n}Object.defineProperty(e,"__esModule",{value:!0}),e.initCookieSync=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){}},function(t,e,n){"use strict";function i(t){document.addEventListener("click",function(e){var n=e.target||e.srcElement;/.*track-click.*/.test(n.className)&&t.events.trackClick(n.id).send()},!1)}Object.defineProperty(e,"__esModule",{value:!0}),e.button=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){}},function(t,e,n){"use strict";function i(t){document.addEventListener("click",function(e){var n=e.target||e.srcElement;/.*track-engagement.*/.test(n.className)&&t.events.trackEngagement((0,r.getViewDuration)(),(0,r.getScrollPosition)(),"Click",n.tagName,n.id,n.getAttribute("p2-action"),n.getAttribute("p2-meta")).send()},!1)}Object.defineProperty(e,"__esModule",{value:!0}),e.engagement=i;var r=n(0)},function(t,e,n){"use strict";function i(t){function e(t,e,n){return t[e]?t[e]:n}var n=t.opts.impliedEvents;n&&n.map(function(n){var i;switch(i=n.params,n.track.toLowerCase()){case"create":t.events.trackCreate(e(i,0),e(i,1),e(i,2,{})).send();break;case"login":t.events.trackLogin(e(i,0),e(i,1),e(i,2,{})).send();break;case"logout":t.events.trackLogout(e(i,0),e(i,1),e(i,2,{})).send();break;case"reply":t.events.trackReply(e(i,0),e(i,1),e(i,2,{})).send();break;case"update":t.events.trackUpdate(e(i,0),e(i,1),e(i,2,{})).send();break;case"refer":t.events.trackRefer(e(i,0),e(i,1),e(i,2,{})).send();break;case"report":t.events.trackReport(e(i,0),e(i,1),e(i,2,{})).send()}})}Object.defineProperty(e,"__esModule",{value:!0}),e.impliedEvents=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){}},function(t,e,n){"use strict";function i(t){t.events.trackContentView().send()}function r(t){document.addEventListener("hashchange",function(){t.events.trackContentView().send()},!1)}function o(t){function e(){i||(i=!0,t.events.trackEngagementTime((0,s.dateNow)()-n).queue(),t.events.trackExit().queue(),t.queue.persistToLocalStorage())}var n=(0,s.dateNow)(),i=!1;document.addEventListener("click",function(e){var r,o,a,c;i&&(i=!0,r=e.target,"a"===r.tagName.toLowerCase()&&(o=r.getAttribute("href"),a=/^https?:\/\//i,o.match(a)&&(t.events.trackEngagementTime((0,s.dateNow)()-n).queue(),c=t.events.trackExit("sdrn:exit:"+o,"Page"),c.addProperty("secondary","url",o),c.queue(),t.sendQueue())))},!1),window.addEventListener("beforeunload",e),window.addEventListener("unload",e,!1)}Object.defineProperty(e,"__esModule",{value:!0}),e.pageLoad=i,e.hashChange=r,e.pageUnload=o;var s=n(0)},function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t){if(this.utils=d,!t)throw new Error("options object is required");if(!t.clientId)throw new Error("clientId is required");t.optOut||(this.optOut=!1,this.waitForOptOut=!1,t.waitForOptOut&&(this.optOut="wait",this.waitForOptOut=!0),this.vars=T,this.version=E,this.clientId=("sdrn:schibsted:client:"+t.clientId).toLowerCase(),t.url?this.url=t.url+"/"+this.clientId:this.url=this.vars.envVars.dataCollectorUrl+"/"+this.clientId,this.pageViewId=(0,u.getUuidV4)(),t.transport?this.transport=t.transport:this.transport=new g.default,t.respectDoNotTrack===!0&&navigator&&1===parseInt(navigator.doNotTrack,10)?this.allowTracking=!1:this.allowTracking=!0,this.opts=t,this.contentId=t.contentId||t.pageId||encodeURIComponent(document.location),this.contentType=t.contentType||t.pageType||"Content",this.userIdDomain=t.userIdDomain,this.noRedirect=!0,this.enrichmentFailed=!1,this.queue=new m.default(100,{persistOnUpdate:(t.trackingFeatures||{}).persistAllEvents,loadFromLocalStorage:(t.trackingFeatures||{}).persistAllEvents}),this.events=new c.default(this),this.user=new h.default({userId:this.opts.userId,userIdDomain:this.opts.userIdDomain,userServiceUrl:this.opts.userServiceUrl,noRedirect:this.noRedirect,transport:this.transport,utils:this.utils,waitForOptOut:this.waitForOptOut,jwe:this.opts.jwe}),this.plugins=new j.default(this.opts),this.trigger=new k.default(this.opts,this.plugins),this.initIds(function(){}),this.plugins.call(this.plugins.sdkLoad,this))}Object.defineProperty(e,"__esModule",{value:!0});var s=n(1),a=n(40),c=r(a),u=n(0),d=i(u),p=n(46),h=r(p),l=n(41),f=r(l),y=n(8),g=r(y),v=n(39),m=r(v),b=n(42),j=r(b),I=n(45),k=r(I),w=n(36),S=r(w),O=n(7),T=i(O);n(47),n(48),n(50),n(49);var E="3.1.12";o.prototype.initIds=function(t){var e=this;t=t||function(){},this.opts.hybridAppMode&&!this.opts.jwe||((0,s.debug)("Fetching Ids"),this.user.getUserId(function(n,i){e.idsDoneCallback(n,i,t),e.plugins.call(e.plugins.sdkReady,e)}))},o.prototype.registerPlugin=function(t,e,n){this.plugins.on(t,e,n)},o.prototype.unRegisterPlugin=function(t,e,n){this.plugins.off(t,e,n)},o.prototype.idsDoneCallback=function(t,e,n){var i=this;return t?((0,s.debug)("Failed to fetch ids from CIS "+t),delete this.envId):(this.userId||(this.userId=e.userId),this.envId=e.envId),this.waitingToTransmitQueue=!1,this.sendQueue(),this.user.syncIdsWithServer(function(){return new S.default(i.user).start()}),new S.default(this.user).start(),this.doAppNexusPixelSync(),n(e)},o.prototype.doAppNexusPixelSync=function(){var t,e="https://secure.adnxs.com/getuid?https://cis.schibsted.com/api/v1/sync?ANID=$UID";this.user.shouldSyncWithAn&&(this.user.shouldSyncWithAn=!1,this.user.setAnIdUnresolved(),t=new f.default(e,"pulse2an",1),t.initPixel())},o.prototype.sendQueue=function(t){var e,n,i=this;if(t=t||function(){},!this.queue.count())return t("no items in queue");if(!this.allowTracking)return t("tracking not allowed");if(this.plugins.call(this.plugins.eventCreated,this.queue.peekAll()),"send"!==this.isUserInfoResolved()||"send"!==this.optOutAction())return this.waitingToTransmitQueue=!0,t("not ready to send");for((0,s.debug)("Sending queue"),n=this.queue.dequeueAll(),e=0;e<n.length;e++)this.enrichEvents(n[e]);this.enrichmentFailed||(this.plugins.call(this.plugins.eventReady,n),this.transport.post(this.url,n,function(e){e?((0,s.debug)("Failed to send queue"),i.queue.enqueueMany(n),t(e)):(i.plugins.call(i.plugins.eventSent,n),t(null,!0))}))},o.prototype.send=function(t,e){var n=this;return e||(e=function(){}),this.allowTracking?(this.plugins.call(this.plugins.eventCreated,t),"send"!==this.isUserInfoResolved()||"send"!==this.optOutAction()?(this.queue.enqueue(t),this.waitingToTransmitQueue=!0,e("not ready to send")):((0,s.debug)("Sending object"),this.enrichEvents(t),void(this.enrichmentFailed||(this.plugins.call(this.plugins.eventReady,t),this.transport.post(this.url,[t],function(i){i?((0,s.debug)("Failed to send object"),n.queue.enqueue(t),e(i)):(n.plugins.call(n.plugins.eventSent,t),e(null,!0))}))))):e("tracking not allowed")},o.prototype.optOutAction=function(){return this.waitForOptOut&&"wait"===this.optOut?"wait":this.waitForOptOut&&this.optOut?"discard":"send"},o.prototype.setOptOut=function(t,e){return this.optOut=t,this.waitingToTransmitQueue=!1,this.sendQueue(e)},o.prototype.isUserInfoResolved=function(){return"undefined"==typeof this.envId?"SDK: Waiting for envId":this.envId.indexOf("undefined")>-1?(delete this.envId,"SDK: Waiting for envId"):this.user.doTracking===!1?"CIS: user has opted out":"send"},o.prototype.enrichEvents=function(t){this.addTheIds(t),this.user&&this.user.localCookieNotSet&&(t.tracker.localCookieNotSet=!0)},o.prototype.addTheIds=function(t){var e=this.user.getTheEnvironmentId(),n=this.user.getTheUserId(),i=this.user.getTheJwe(),r=(0,u.objectKeys)(this.user.idObj.altEnvIds||{});if(e&&"undefined"!==e){if(0!==String(e).indexOf("sdrn:")){if(e.length>40)return void this.deleteEnvId();t.device.environmentId="sdrn:schibsted:environment:"+e}else{if(e.length>70)return void this.deleteEnvId();t.device.environmentId=e}i&&(t.device.jweIds=i),n&&(t.actor=t.actor||{},t.actor["@id"]=n,t.actor["spt:userId"]=n),r&&r.length>0&&(r=r.map(function(t){return 0!==String(t).indexOf("sdrn:")?"sdrn:schibsted:environment:"+t:t}),t.device.additionalEnvironmentIds=r)}},o.prototype.deleteEnvId=function(){this.enrichmentFailed=!0,delete this.user.idObj.envId,this.refreshUserIds()},o.prototype.getPageViewId=function(){return this.pageViewId},o.prototype.setNewPageViewId=function(){this.pageViewId=(0,u.getUuidV4)()},o.prototype.userLogout=function(){delete this.user.idObj.userId,this.refreshUserIds()},o.prototype.userLogin=function(t){this.user.idObj.userId=t,this.refreshUserIds()},o.prototype.refreshUserIds=function(){this.waitingToTransmitQueue=!0,this.user.didSync=!1,this.initIds()},o.prototype.setJWE=function(t){this.opts.hybridAppMode&&(this.opts.jwe=t,this.user.opts.jwe=t,this.initIds())},e.default=o},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t){this.referenceUrls=t.referenceUrls,this.user=t,this.transport=t.transport||new s.default,this.pointer=0}Object.defineProperty(e,"__esModule",{value:!0});var o=n(8),s=i(o),a=n(0);r.prototype.start=function(){this.referenceUrls&&Array.isArray(this.referenceUrls)&&this.callCurrentIDService()},r.prototype.callCurrentIDService=function(){var t=this;this.pointer>20||this.referenceUrls.length<=this.pointer||!this.referenceUrls[this.pointer]||this.transport.get("https://"+this.referenceUrls[this.pointer]+"/api/v1/pulse",null,function(e,n){return t.handleResponse(e,n)},1,!0)},r.prototype.handleResponse=function(t,e){var n;if(this.pointer++,!t&&e&&e.responseText){try{n=JSON.parse(e.responseText)}catch(t){return}return n&&n.pulse2data?(this.cacheOldEnvironmentId(this.user.idObj.envId),void this.user.replaceCookieValue(n.pulse2data)):void this.callCurrentIDService()}},r.prototype.cacheOldEnvironmentId=function(t){var e,n,i,r,o,s,c={};if(this.user.idObj.altEnvIds=this.user.idObj.altEnvIds||{},this.user.idObj.altEnvIds[t]=(0,a.dateNow)(),e=Object.keys(this.user.idObj.altEnvIds),e.length>5){for(n=0;n<e.length;n++){for(o=this.user.idObj.altEnvIds[e[n]],r=0,i=0;i<e.length;i++)n!==i&&(s=this.user.idObj.altEnvIds[e[i]],parseInt(o,10)>parseInt(s,10)&&r++);r>=e.length-5&&(c[e[n]]=o)}this.user.idObj.altEnvIds=c}},e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){return function(){}}},function(t,e,n){"use strict";function i(t,e){if(!t)throw new Error("data required");try{this.data=t.getSchema()}catch(t){throw new Error("get schema function required")}if(!t.activity)throw new Error("data must have property activity");this.activity=t.activity,this.objectOrder=e||[]}Object.defineProperty(e,"__esModule",{value:!0}),i.prototype.queue=function(){this.activity.queue.enqueue(this.data)},i.prototype.send=function(t){this.activity.send(this.data,t)},i.prototype.addProperty=function(t,e,n){var i=this.getObjectKey(t);return this.data[i][e]=n,this},i.prototype.addCustomData=function(t,e){var n=this.getObjectKey(t);return this.data[n]["spt:custom"]=e,this},i.prototype.getObjectKey=function(t){if("primary"===t)return this.objectOrder[0];if("secondary"===t)return this.objectOrder[1];if("tertiary"===t)return this.objectOrder[2];throw new Error("Object reference not valid")},e.default=i},function(t,e,n){"use strict";function i(t,e){if(!t)throw new Error("size of the queue must be given");this.options=e||{},this.maxSize=t,this.queue=[],this.options.loadFromLocalStorage&&this.loadFromLocalStorage()}Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o="_pulse2-queue";i.prototype.persistToLocalStorage=function(){try{(0,r.checkLocalStorage)(),localStorage.setItem(o,JSON.stringify(this.queue))}catch(t){}},i.prototype.loadFromLocalStorage=function(){var t;try{(0,r.checkLocalStorage)(),t=JSON.parse(localStorage.getItem(o)),t&&(0,r.isArray)(t)&&(this.queue=this.queue.concat(t))}catch(t){}},i.prototype.enqueue=function(t){this.queue.push(t),this.queue.length>this.maxSize&&this.queue.shift(),this.options.persistOnUpdate&&this.persistToLocalStorage()},i.prototype.enqueueMany=function(t){if(!(0,r.isArray)(t))throw new Error("elements must be an array");this.queue=this.queue.concat(t),this.queue.length>this.maxSize&&(this.queue=this.queue.slice(this.queue.length-this.maxSize,this.queue.length)),this.options.persistOnUpdate&&this.persistToLocalStorage()},i.prototype.dequeue=function(){var t=this.queue.shift();return this.options.persistOnUpdate&&this.persistToLocalStorage(),t},i.prototype.dequeueAll=function(){var t=this.queue.splice(0,this.queue.length);return this.options.persistOnUpdate&&this.persistToLocalStorage(),t},i.prototype.peek=function(){return this.queue[0]},i.prototype.peekAll=function(){return this.queue},i.prototype.count=function(){return this.queue.length},e.default=i},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function r(t){if(!t)throw new Error("activity required");this.activity=t,this.opts=t.opts,this.contentId=t.contentId,this.contentType=t.contentType}Object.defineProperty(e,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s=n(38),a=i(s),c=n(44),u=i(c),d=n(0),p=n(1);r.prototype.getSdrnIdWithContentType=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.clientId,n=t.targetType,i=t.targetId;return i=i||this.activity.contentId,i&&i.indexOf&&0===i.indexOf("sdrn:")?i:(0,d.getSdrnIdWithContentType)(e||this.activity.opts.clientId,n||this.activity.contentType,i||this.activity.contentId)},r.prototype.trackContentView=function(t){var e=new u.default(this.activity);return e.type="View",e.object=this.addPageStandards(e.object),e.object.name=t||document.title,e.object.properties={},e.object.properties=this.reMapCustom(e.object.properties,"@type"),e.object.properties=this.reMapCustom(e.object.properties,"action"),e.object.properties=this.reMapCustom(e.object.properties,"item"),this.opts.filters&&(e.object.filters=this.opts.filters),document.referrer&&(e.origin={url:document.referrer}),this.opts.targetId&&this.opts.targetType&&(e.target={},e.target=this.addPageStandards(e.target,this.opts.targetId,this.opts.targetType)),e.tracker.trackingMethod="trackContentView",new a.default(e,["object","origin"])},r.prototype.trackBasic=function(t,e,n,i,r,s,c){var d=new u.default(this.activity);return e=e||"Content",n=n||"undefined",d.id=this.getSdrnIdWithContentType({targetType:e,targetId:n}),d.type=t||"View","object"===("undefined"==typeof i?"undefined":o(i))?d.addCustomDataToProperty(d.object,i):(0,p.debug)("events.js:trackBasic: objectMeta must be an object",d.activity.opts.debugMode),d.object["@id"]=this.getSdrnIdWithContentType({targetType:e,targetId:n}),d.object["@type"]=e,d.origin=this.addPageStandards(d.origin),e&&(d.object=this.addPageStandards(d.object,n,e)),r&&(d.schema.intent=r),s&&(d.provider=Object.assign({},d.provider,s)),c&&d.createExperiments(c),d.tracker.trackingMethod="trackBasic",new a.default(d,["object","origin"])},r.prototype.trackCreate=function(t,e,n){var i=this.trackBasic("Create",t,e,n);return i.tracker=(i.tracker||{}).trackingMethod="trackCreate",i},r.prototype.trackUpdate=function(t,e,n){var i=this.trackBasic("Update",t,e,n);return i.tracker=(i.tracker||{}).trackingMethod="trackUpdate",i},r.prototype.trackSave=function(t,e,n){return this.trackBasic("Save",t,e,n)},r.prototype.trackUnsave=function(t,e,n){return this.trackBasic("Unsave",t,e,n)},r.prototype.trackReply=function(t,e,n){var i=new u.default(this.activity),r=t||"Message",o=e||this.opts.contentId;return i.type="Create",i.addCustomDataToProperty(i.object,n),i.object=this.addPageStandards(i.object,o,r),i.origin=this.addPageStandards(i.origin),i.tracker.trackingMethod="trackReply",new a.default(i,["object","origin"])},r.prototype.trackRefer=function(t,e,n){var i=this.trackBasic("Refer",t,e,n);return i.tracker=(i.tracker||{}).trackingMethod="trackRefer",i},r.prototype.trackReport=function(t,e,n){var i=this.trackBasic("Report",t,e,n);return i.tracker=(i.tracker||{}).trackingMethod="trackReport",i},r.prototype.trackLogin=function(t,e,n){var i=this.trackBasic("Login",t,e,n);return i.tracker=(i.tracker||{}).trackingMethod="trackLogin",i},r.prototype.trackLogout=function(t,e,n){var i=this.trackBasic("Logout",t,e,n);return i.tracker=(i.tracker||{}).trackingMethod="trackLogout",i},r.prototype.trackClick=function(t,e,n,i,r){var o=new u.default(this.activity);return o.schema.schema="http://schema.schibsted.com/events/engagement-event.json/139.json#",o.type=r||"Engagement",o.origin=this.addPageStandards(o.origin),o.action="Click",o.object["@id"]=this.getSdrnIdWithContentType({targetId:i,targetType:n})+":element:"+t,o.object["@type"]="UIElement",o.object.name=e,o.schema.target=this.addPageStandards(o.origin,i,n),o.tracker.trackingMethod="trackClick",new a.default(o,["object","target"])},r.prototype.trackSocial=function(){return this.trackEngagement()},r.prototype.trackMediaState=function(t,e,n){var i=new u.default(this.activity);return i.type=n||"Watch",i.object={"@type":"UIElement","@id":this.getSdrnIdWithContentType()+":element:"+t,elementType:e},i.origin=this.addPageStandards(i.origin),i.tracker.trackingMethod="trackMediaState",new a.default(i,["object","origin"])},r.prototype.trackScroll=function(t){return this.trackEngagement(!1,t)},r.prototype.trackVisibility=function(t){var e=this.trackContentView();return e.data.object["@id"]=this.getSdrnIdWithContentType(this.activity.contentType,this.activity.contentId)+(":element:"+t),e.data.object["@type"]="UIElement",e},r.prototype.trackExit=function(t,e,n){var i=new u.default(this.activity);return i.type=n||"View",i.schema.intent="Close",i.object=this.addPageStandards(i.object),i.schema.target={},"undefined"!=typeof t&&"undefined"!=typeof e&&(i.schema.target=this.addPageStandards(i.origin,t,e)),
i.tracker.trackingMethod="trackExit",new a.default(i,["object","target"])},r.prototype.trackEngagement=function(t,e,n,i,r,s,c){var h,l=new u.default(this.activity);if(l.schema.schema="http://schema.schibsted.com/events/engagement-event.json/139.json#",l.type="Engagement",l.origin=this.addPageStandards(l.origin),l.action=n,c){if(h=c,"string"==typeof c)try{h=JSON.parse(c)}catch(t){(0,p.debug)("Error parsing JSON: "+t,l.activity.opts.debugMode)}"object"===("undefined"==typeof h?"undefined":o(h))&&l.addCustomDataToProperty(l.object,h)}return i&&r?(l.object["@id"]=l.origin["@id"]+":element:"+r,l.object["@type"]="UIElement",l.object.elementType=i,l.object.action=s):l.object=this.addPageStandards(l.object),t||0===t?l.schema.duration=t:l.schema.duration=(0,d.getViewDuration)(),e||0===e?l.schema.scrollPosition=e:l.schema.scrollPosition=(0,d.getScrollPosition)(),l.tracker.trackingMethod="trackEngagement",new a.default(l,["object"])},r.prototype.trackEngagementTime=function(t,e,n){return this.trackEngagement(t,n)},r.prototype.trackCustomEvent=function(t,e,n){var i=new u.default(this.activity);return i.type=e||"View",i.object=this.addPageStandards(i.object),"object"===("undefined"==typeof n?"undefined":o(n))&&i.addCustomDataToProperty(i.object["spt:custom"],n),t&&(i.provider.eventIdentifier=t),i.tracker.trackingMethod="trackCustomEvent",new a.default(i,["object"])},r.prototype.trackCustom=function(t,e){var n=new u.default(this.activity);return n.type="CustomEvent",n.subtype=t&&!~t.indexOf("custom:")?"custom:".concat(t):t||"custom:Content",n.object=this.addPageStandards(n.object),n.schema.schema="http://schema.schibsted.com/events/custom-event.json/77.json#","object"===("undefined"==typeof e?"undefined":o(e))&&(n.custom=e),n.tracker.trackingMethod="trackCustom",new a.default(n,["object"])},r.prototype.addPageStandards=function(t,e,n){return e=e||this.activity.contentId,n=n||this.activity.contentType,t=t||{},t["@type"]=n,String(this.activity.contentId).indexOf("sdrn:")>-1?t["@id"]=e:t["@id"]=this.getSdrnIdWithContentType({targetType:n,targetId:e}),t.contentId=e,t.url=document.URL,t.name=document.title,this.opts.inLanguage&&(t.inLanguage=this.opts.inLanguage),this.opts.tags&&(0,d.isArray)(this.opts.tags)&&(t.tags=this.opts.tags),this.validateAndSet(t,"adType",this.opts.adType,"string"),this.validateAndSet(t,"location",this.opts.contentLocation,"object"),this.validateAndSet(t,"publisher",this.opts.publisher,"object"),this.validateAndSet(t,"publisherType",this.opts.publisherType,"string"),this.validateAndSet(t,"images",this.opts.images,"object"),this.validateAndSet(t,"creationDate",this.opts.creationDate,"string"),this.validateAndSet(t,"price",parseInt(this.opts.price,10),"number"),this.validateAndSet(t,"currency",this.opts.currency,"string"),this.validateAndSet(t,"adId",parseInt(this.opts.adId,10),"number"),this.validateAndSet(t,"items",this.opts.items,"object"),this.addCategoryToEvents(t)},r.prototype.validateAndSet=function(t,e,n,i){if(e&&n)return i&&("undefined"==typeof n?"undefined":o(n))!==i?(console.log("not valid"+e+" : "+i),void(0,p.debug)(e+" is not of type "+i,this.activity.opts.debugMode)):void(t[e]=n)},r.prototype.addCategoryToEvents=function(t){var e=this.activity.opts,n="";return e.provider=e.provider||{},e.object=e.object||{},e.category?n=e.category:e.object.category?n=e.object.category:e.provider.category&&(n=e.provider.category),(0,d.isArray)(n)&&(n=n.toString()),n&&(t.category=n),t},r.prototype.getDomainFromUrl=function(t){var e=t.match(/^https?\:\/\/(www.)?([^\/:?#]+)(?:[\/:?#]|$)/i);return e&&e[2]},r.prototype.reMapCustom=function(t,e,n){return n!==!1&&(n=!0),this.opts.object&&this.opts.object.properties&&this.opts.object.properties[e]?(t[e]=this.opts.object.properties[e],n&&delete this.opts.object.properties[e],t):t},e.default=r},function(t,e,n){"use strict";function i(t,e,n){this.collectorBaseUrl=t,this.service=e||"pulse2",this.clientId="",this.pageViewId="",this.throttle=.1,n>=0&&(this.throttle=n)}Object.defineProperty(e,"__esModule",{value:!0}),i.prototype.initPixel=function(){Math.random()<this.throttle&&this.collectorBaseUrl&&this.injectPixel()},i.prototype.injectPixel=function(){var t=this._createImgElement(),e=document.getElementsByTagName("body");e.item(0).appendChild(t)},i.prototype._createImgElement=function(){var t=document.createElement("img");return t.src=this.collectorBaseUrl,t.id=this.service+"pixel",t.style.display="none",t},e.default=i},function(t,e,n){"use strict";function i(t){this.opts=t,this.plugins=window.pulse2plugins||[],this.hooks={eventCreated:this.plugins.eventCreatedHooks||[],eventReady:this.plugins.eventReadyHooks||[],eventSent:this.plugins.eventSentHooks||[],load:this.plugins.onLoadHooks||[],ready:this.plugins.onReadyHooks||[]},this.sdkReady="ready",this.sdkLoad="load",this.eventCreated="eventCreated",this.eventReady="eventReady",this.eventSent="eventSent"}Object.defineProperty(e,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=n(0),s=n(1);i.prototype.call=function(t,e){switch(t){case this.eventCreated:case this.eventReady:case this.eventSent:return this.callEventHooks(e,this.hooks[t]);case this.sdkReady:case this.sdkLoad:return this.callSdkHooks(e,this.hooks[t]);default:return}},i.prototype.callEventHooksArray=function(t,e){var n,i=[];for(n=0;n<t.length;n++)i.push(this.callEventHooks(t[n],e));return i},i.prototype.callEventHooks=function(t,e){var n,i,r,a;if(e=e||[],(0,o.isArray)(t))return this.callEventHooksArray(t,e);if(!t["@type"])return t;for(a=0;a<e.length;a++)if(n=e[a],i=(0,o.objectKeys)(n)[0].toLowerCase(),"all"===i||i===t["@type"].toLowerCase())try{r=n[i](t),r&&(t=r)}catch(t){(0,s.debug)("plugins.js: A pulse2 sdk plugin failed: "+t,this.opts.debugMode)}return t},i.prototype.callSdkHooks=function(t,e){var n;if("object"===("undefined"==typeof e?"undefined":r(e))&&"object"===("undefined"==typeof t?"undefined":r(t)))for(n=0;n<e.length;n++)try{e[n](t)}catch(t){(0,s.debug)("plugins.js: A pulse2 event plugin failed: "+t,this.opts.debugMode)}},i.prototype.on=function(t,e,n){var i={};t&&e&&(n?i[n]=e:i=e,this.hooks[t].push(i))},i.prototype.off=function(t,e,n){if(t)return e?void(this.hooks[t]=this.hooks[t].filter(function(t){return n?t[n]!==e:t!==e})):void(this.hooks[t]=[])},e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.envVars={dataCollectorUrl:"https://collector.schibsted.io/api/v1/track",userServiceUrl:"https://cis.schibsted.com/api/v1/identify",errorReportingUrl:""}},function(t,e,n){"use strict";function i(t,e){if(!t)throw new Error("Activity needed");this.activity=t,this.reducedEvent=e,this.schema={},this.type=null,this.actor={},this.device={},this.provider={},this.object={},this.origin={},this.location={},this.tracker={},this.initSchema()}Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);i.prototype.initSchema=function(){this.schema["@id"]=(0,r.getUuidV4)(),this.activity.opts.intent&&(this.schema.intent=this.activity.opts.intent),this.schema.pageViewId=this.activity.pageViewId,this.schema.creationDate=(0,r.getTimestamp)(),this.schema.schema="http://schema.schibsted.com/events/tracker-event.json/115.json",!this.activity.opts.deployStage||"dev"!==this.activity.opts.deployStage&&"pre"!==this.activity.opts.deployStage||(this.schema.deployStage=this.activity.opts.deployStage,this.activity.opts.deployTag&&(this.schema.deployTag=this.activity.opts.deployTag)),this.createTracker(),this.createDevice(),this.createProvider(),this.createObject(),this.createOrigin(),this.createLocation(),this.createExperiments(),this.addCustomData()},i.prototype.populateSchema=function(){this.schema["@type"]=this.type,this.schema.subtype=this.subtype,this.schema.action=this.action,this.schema.tracker=this.tracker,this.schema.device=this.device,this.schema.provider=this.provider,this.schema.object=this.object,this.schema.origin=this.origin,this.schema.location=this.location,this.actor&&this.actor.hasOwnProperty("@id")&&(this.schema.actor=this.actor),this.target&&(this.schema.target=this.target),this.result&&(this.schema.result=this.result),this.scrollPosition&&(this.schema.scrollPosition=this.scrollPosition),this.duration&&(this.schema.duration=this.duration),this.custom&&(this.schema.custom=this.custom),this.experiments&&(this.schema.experiments=this.experiments)},i.prototype.createDevice=function(){if(!this.reducedEvent){this.device.deviceType=(0,r.getDeviceType)(navigator.userAgent),this.device.acceptLanguage=(0,r.getDeviceLanguage)(),this.device.screenSize=window.screen.width+"x"+window.screen.height,this.device.userAgent=navigator.userAgent,this.device.viewportSize=(0,r.getViewportDimensions)();try{(0,r.checkLocalStorage)(),this.device.localStorageEnabled=!0}catch(t){this.device.localStorageEnabled=!1}}},i.prototype.createObject=function(){this.object["spt:custom"]={}},i.prototype.createOrigin=function(){},i.prototype.createTracker=function(){this.tracker.version=this.activity.version,this.tracker.type="JS",this.reducedEvent||this.extendedTrackerData()},i.prototype.extendedTrackerData=function(){this.tracker.performance={},this.tracker.name="Pulse v2 tracker JS SDK",window&&window.performance&&(this.tracker.performance.browser={},this.tracker.performance.browser=window.performance.timing)},i.prototype.createLocation=function(){this.activity.opts&&this.activity.opts.location&&(this.location["@type"]="Place",this.location.latitude=this.activity.opts.location.latitude,this.location.longitude=this.activity.opts.location.longitude,this.location.accuracy=this.activity.opts.location.accuracy)},i.prototype.createExperiments=function(t){if(t||this.activity.opts&&this.activity.opts.experiments&&0!==this.activity.opts.experiments.length){t=t||this.activity.opts.experiments,this.experiments=[];for(var e=0;e<t.length;e++){var n=t[e];n&&n.id&&n.variant&&this.experiments.push({"@type":"Experiment","@id":(0,r.getSdrnIdWithContentType)(n.platform||this.activity.opts.clientId,"experiment",n.id),variant:n.variant,layer:n.layer})}}},i.prototype.createProvider=function(){this.provider["@type"]="Organization",this.provider["@id"]=this.activity.clientId,this.provider.url=document.URL,this.provider.product=this.activity.opts.product||this.activity.opts.clientId,this.provider.productType=this.activity.opts.productType,this.provider.component=this.activity.opts.component},i.prototype.addCustomData=function(){this.activity.opts&&(this.addCustomDataToProperty(this.provider,this.activity.opts.provider),this.addCustomDataToProperty(this.object["spt:custom"],this.activity.opts.object))},i.prototype.addCustomDataToProperty=function(t,e){var n;for(n in e)t.hasOwnProperty(n)||(t[n]=e[n])},i.prototype.getSchema=function(){return this.populateSchema(),this.schema},i.prototype.getString=function(){return JSON.stringify(this.getSchema())},e.default=i},function(t,e,n){"use strict";function i(t,e){this.opts=t,this.plugins=e,this.registerTriggers()}Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(1);i.prototype.registerTriggers=function(){this.plugins&&this.plugins.on(this.plugins.sdkLoad,this.getUrlTriggers)},i.prototype.getUrlTriggers=function(t){var e,n,i,s,a,c,u=(0,r.getUrlParams)("p2param");for(n=0;n<u.length;n++){for(c={},s=u[n].split("."),i=s.slice(2),a=0;a<i.length;a++)try{i[a]=i[a].split("_"),c[i[a][0]]=i[a][1]}catch(t){(0,o.debug)("trigger.js: An error occurred while reading URL param: "+t,this.opts.debugMode)}e=t.events.trackCustomEvent(null,s[0],c),e.data.object.name=s[1],e.data.object["@id"]+=":elementId:"+s[1],e.send()}},e.default=i},function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(t){t=t||{},this.idObj={},this.cookieKey="_pulse2data",this.envCookieKey="_pulse2env",this.cookiesAllowed=navigator.cookieEnabled,this.anonIdPlaceholder="x",this.opts=t,this.userIdDomain=t.userIdDomain||"schibsted.com",this.userId=this.opts.userId,this.userId||(delete this.userId,delete this.opts.userId),this.visitorIdPlaceholder="v",this.redirectString="https://cis.schibsted.com/redirect/?redirectUrl="+document.location,this.userServiceUrl=t.userServiceUrl||d.envVars.userServiceUrl,this.transport=t.transport||new c.default,this.referenceUrls=null,this.noRedirect=!0,this.doValidation=!1,this.shouldSyncWithAn=!1,this.shouldFetchFromAn=!1,this.hasCookie=!1,this.anSyncUrl="https://secure.adnxs.com/getuidj",this.doTracking=!0,this.anSyncStatus="nothing has happened",this.didSync=!1,"undefined"!=typeof t.noRedirect&&(this.noRedirect=t.noRedirect)}Object.defineProperty(e,"__esModule",{value:!0});var s=n(0),a=n(8),c=r(a),u=n(7),d=i(u);o.prototype.getUserId=function(t){var e;return t=t||function(){},e=this.getIdsFromCookie(),this.userId&&(e.userId=this.createUserIdWithSdrn(this.userId)),this.mapUserData(e),this.idObj.envId?t(null,this.idObj):this.syncIdsWithServer(t)},o.prototype.syncIdsWithServer=function(t){var e=this;t=t||function(){},!this.idObj.envId||this.userStatusHasChanged()||this.doValidation||setTimeout(function(){return e.doAppNexusSync()},2e3),this.doValidation!==!0&&this.idObj.envId||this.didSync!==!1||(this.didSync=!0,this.getIdsFromService({envId:!this.idObj.jwe&&this.idObj.envId,jwe:this.idObj.jwe,userId:this.idObj.userId},function(n,i){return e.onIdServiceResponse(n,i,t)})),this.doValidation=!1,this.doAppNexusSync(null,function(){return t(null,e.idObj)})},o.prototype.replaceCookieValue=function(t,e){var n=this.getIdsFromCookie(t,e);this.mapUserData(n),this.syncIdsWithServer(),this.setIdsInCookie()},o.prototype.mapUserData=function(t){var e,n,i=["undefined","false","0","","null"];this.idObj.userId=t.userId||this.idObj.userId,this.idObj.envId=t.environmentId||t.envId,this.idObj.altEnvIds=t.altEnvIds||this.idObj.altEnvIds,this.idObj.prevUserId=t.prevUserId,this.idObj.anId=t.anId||this.idObj.anId,this.idObj.jwe=this.opts.jwe||t.jwe||this.idObj.jwe,this.idObj.pixelInjected=t.pixelInjected||null,this.idObj.adId=t.adId||this.idObj.adId||null,t.doAnSync&&(this.shouldSyncWithAn=t.doAnSync),this.doTracking=this.resolveDoTracking(t.doTracking),this.idObj.userId&&(e=this.idObj.userId.split(":"),n=e[e.length-1],i.indexOf(n)>=0&&delete this.idObj.userId),this.setIdsInCookie()},o.prototype.setIdsInCookie=function(){var t,e=this.idObj.userId||this.anonIdPlaceholder,n=new Date,i=new Date,r=new Date,o=n.getTime();this.idObj.envId&&(n.setTime(o+9e5),i.setTime(o+144e5),r.setTime(o+63072e6),t=[this.idObj.envId,this.visitorIdPlaceholder,e,n.getTime(),this.idObj.jwe,this.idObj.anId,i.getTime(),this.doTracking.toString(),this.idObj.pixelInjected,this.idObj.adId],(0,s.deleteCookie)(this.cookieKey,document.domain),(0,s.writeCookie)(this.cookieKey,t,(0,s.broadenDomain)(document.domain),r.toUTCString()),this.idObj.altEnvIds&&(0,s.writeCookie)(this.envCookieKey,JSON.stringify(this.idObj.altEnvIds),(0,s.broadenDomain)(document.domain),r.toUTCString()))},o.prototype.getIdsFromCookie=function(t,e){var n,i,r=t||(0,s.getCookie)(this.cookieKey),o=e||(0,s.getCookie)(this.envCookieKey);if(!r||r.indexOf("undefined")!==-1)return(0,s.deleteCookie)(this.cookieKey),this.shouldSyncWithAn=!0,{};if(n=r.split(","),n.length<2)return(0,s.deleteCookie)(this.cookieKey),{};if(n[3]&&(0,s.dateNow)()>parseInt(n[3],10)&&(this.doValidation=!0,this.hasCookie=!0),n[6]&&(0,s.dateNow)()>parseInt(n[6],10)&&(this.shouldSyncWithAn=!0,this.doValidation=!1),n[5]&&"unresolved"!==n[8]||(n[8]="unresolved",this.shouldFetchFromAn=!0),i={environmentId:n[0],prevUserId:n[2],jwe:n[4],anId:n[5],doTracking:n[7],pixelInjected:n[8],adId:n[9]},o)try{i.altEnvIds=JSON.parse(o)}catch(t){}return i},o.prototype.getIdsFromService=function(t,e){var n=this,i=this.userServiceUrl,r=3,o={userId:t.userId,jwe:t.jwe};t.envId&&(o.environmentId=t.envId),t.anId&&(o.anId=t.anId),this.opts.waitForOptOut&&(o.waitForOptOut=this.opts.waitForOptOut),this.hasCookie&&(r=1),this.transport.post(i,o,function(t,i){var r;return t?void e(t):(r=JSON.parse(i.response||i.responseText),r.data.anid&&"0"!==r.data.anid||(r.data.doAnSync=!0),n.mapUserData(r.data),void e(null,r.data))},!0,r)},o.prototype.onIdServiceResponse=function(t,e,n){return t?void n(t):(e&&e.crossReference&&Array.isArray(e.crossReference)&&(this.referenceUrls=e.crossReference),this.hasCookie?(this.hasCookie=!1,n(null,this.idObj)):n(null,this.idObj))},o.prototype.userStatusHasChanged=function(){var t=this.idObj.userId,e=this.idObj.prevUserId;return!!e&&(t&&e!==t.toString()||!t&&e!==this.anonIdPlaceholder)},o.prototype.doAppNexusSync=function(t,e){var n=this;return e=e||function(){},this.shouldFetchFromAn?(this.shouldFetchFromAn=!1,void this.transport.get(this.anSyncUrl,null,function(t,i){var r,o;return t?e(t,i):(r=JSON.parse(i.response||i.responseText),o={jwe:n.idObj.jwe,userId:n.idObj.userId,anId:r.uid},n.idObj.anId=r.uid,n.mapUserData(n.idObj),n.setAnIdResolved(),n.getIdsFromService(o,function(t,i){return n.onIdServiceResponse(t,i,e)}),e())},1,!0)):t},o.prototype.setAnIdUnresolved=function(){this.idObj.pixelInjected="unresolved",this.setIdsInCookie(this.idObj)},o.prototype.setAnIdResolved=function(){this.idObj.pixelInjected=null,this.setIdsInCookie(this.idObj)},o.prototype.getTheUserId=function(){return this.createUserIdWithSdrn(this.idObj.userId)},o.prototype.getTheEnvironmentId=function(){return this.idObj.envId},o.prototype.getTheJwe=function(){return this.idObj.jwe},o.prototype.getTheAdId=function(){return this.idObj.adId},o.prototype.createUserIdWithSdrn=function(t,e){return!t||String(t).indexOf("undefined")>-1?e:String(t).indexOf("sdrn:")>-1?t:"sdrn:"+this.userIdDomain+":user:"+t},o.prototype.resolveDoTracking=function(t){return t===!0||"true"===t||1===t||t!==!1&&"false"!==t&&0!==t&&this.doTracking},e.default=o},function(t,e,n){n(73),t.exports=n(2).Array.filter},function(t,e,n){n(74),t.exports=n(2).Array.map},function(t,e,n){n(75),t.exports=n(2).Function.bind},function(t,e,n){n(76),t.exports=n(2).Object.assign},function(t,e,n){var i=n(4);t.exports=function(t){if(!i(t))throw TypeError(t+" is not an object!");return t}},function(t,e,n){var i=n(22),r=n(23),o=n(70);t.exports=function(t){return function(e,n,s){var a,c=i(e),u=r(c.length),d=o(s,u);if(t&&n!=n){for(;u>d;)if(a=c[d++],a!=a)return!0}else for(;u>d;d++)if((t||d in c)&&c[d]===n)return t||d||0;return!t&&-1}}},function(t,e,n){var i=n(4),r=n(60),o=n(72)("species");t.exports=function(t){var e;return r(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!r(e.prototype)||(e=void 0),i(e)&&(e=e[o],null===e&&(e=void 0))),void 0===e?Array:e}},function(t,e,n){var i=n(53);t.exports=function(t,e){return new(i(t))(e)}},function(t,e,n){"use strict";var i=n(12),r=n(4),o=n(59),s=[].slice,a={},c=function(t,e,n){if(!(e in a)){for(var i=[],r=0;r<e;r++)i[r]="a["+r+"]";a[e]=Function("F,a","return new F("+i.join(",")+")")}return a[e](t,n)};t.exports=Function.bind||function(t){var e=i(this),n=s.call(arguments,1),a=function(){var i=n.concat(s.call(arguments));return this instanceof a?c(e,i.length,i):o(e,i,t)};return r(e.prototype)&&(a.prototype=e.prototype),a}},function(t,e,n){var i=n(4),r=n(3).document,o=i(r)&&i(r.createElement);t.exports=function(t){return o?r.createElement(t):{}}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){t.exports=!n(9)&&!n(6)(function(){return 7!=Object.defineProperty(n(56)("div"),"a",{get:function(){return 7}}).a})},function(t,e){t.exports=function(t,e,n){var i=void 0===n;switch(e.length){case 0:return i?t():t.call(n);case 1:return i?t(e[0]):t.call(n,e[0]);case 2:return i?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){var i=n(14);t.exports=Array.isArray||function(t){return"Array"==i(t)}},function(t,e,n){"use strict";var i=n(65),r=n(63),o=n(66),s=n(24),a=n(10),c=Object.assign;t.exports=!c||n(6)(function(){var t={},e={},n=Symbol(),i="abcdefghijklmnopqrst";return t[n]=7,i.split("").forEach(function(t){e[t]=t}),7!=c({},t)[n]||Object.keys(c({},e)).join("")!=i})?function(t,e){for(var n=s(t),c=arguments.length,u=1,d=r.f,p=o.f;c>u;)for(var h,l=a(arguments[u++]),f=d?i(l).concat(d(l)):i(l),y=f.length,g=0;y>g;)p.call(l,h=f[g++])&&(n[h]=l[h]);return n}:c},function(t,e,n){var i=n(51),r=n(58),o=n(71),s=Object.defineProperty;e.f=n(9)?Object.defineProperty:function(t,e,n){if(i(t),e=o(e,!0),i(n),r)try{return s(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var i=n(17),r=n(22),o=n(52)(!1),s=n(69)("IE_PROTO");t.exports=function(t,e){var n,a=r(t),c=0,u=[];for(n in a)n!=s&&i(a,n)&&u.push(n);for(;e.length>c;)i(a,n=e[c++])&&(~o(u,n)||u.push(n));return u}},function(t,e,n){var i=n(64),r=n(57);t.exports=Object.keys||function(t){return i(t,r)}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,n){var i=n(3),r=n(18),o=n(17),s=n(11)("src"),a="toString",c=Function[a],u=(""+c).split(a);n(2).inspectSource=function(t){return c.call(t)},(t.exports=function(t,e,n,a){var c="function"==typeof n;c&&(o(n,"name")||r(n,"name",e)),t[e]!==n&&(c&&(o(n,s)||r(n,s,t[e]?""+t[e]:u.join(String(e)))),t===i?t[e]=n:a?t[e]?t[e]=n:r(t,e,n):(delete t[e],r(t,e,n)))})(Function.prototype,a,function(){return"function"==typeof this&&this[s]||c.call(this)})},function(t,e,n){var i=n(19)("keys"),r=n(11);t.exports=function(t){return i[t]||(i[t]=r(t))}},function(t,e,n){var i=n(21),r=Math.max,o=Math.min;t.exports=function(t,e){return t=i(t),t<0?r(t+e,0):o(t,e)}},function(t,e,n){var i=n(4);t.exports=function(t,e){if(!i(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!i(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!i(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}},function(t,e,n){var i=n(19)("wks"),r=n(11),o=n(3).Symbol,s="function"==typeof o,a=t.exports=function(t){return i[t]||(i[t]=s&&o[t]||(s?o:r)("Symbol."+t))};a.store=i},function(t,e,n){"use strict";var i=n(5),r=n(13)(2);i(i.P+i.F*!n(20)([].filter,!0),"Array",{filter:function(t){return r(this,t,arguments[1])}})},function(t,e,n){"use strict";var i=n(5),r=n(13)(1);i(i.P+i.F*!n(20)([].map,!0),"Array",{map:function(t){return r(this,t,arguments[1])}})},function(t,e,n){var i=n(5);i(i.P,"Function",{bind:n(55)})},function(t,e,n){var i=n(5);i(i.S+i.F,"Object",{assign:n(61)})},function(t,e,n){"use strict";function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t){return t&&t.__esModule?t:{default:t}}function o(){var t=decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent("_pulse2debug").replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||!1;return t}Object.defineProperty(e,"__esModule",{value:!0});var s=n(25);Object.keys(s).forEach(function(t){"default"!==t&&"__esModule"!==t&&Object.defineProperty(e,t,{enumerable:!0,get:function(){return s[t]}})});var a,c=n(26),u=r(c),d=i(s),p=n(7),h=i(p),l=n(1),f={},y=!1;o()&&(y=!0),"undefined"!=typeof pulse2opt?f=pulse2opt:"undefined"!=typeof _opt?f=_opt:(0,l.debug)("init.js: Could not find pulse2opt global variable",y),(0,l.debug)("bootstrapping Pulse",y),f.debugMode=y;try{a=f.cookieSyncUrl||h.envVars.cookieSyncUrl,d.initTracking(f),a&&u.default.initCookieSync({url:a,userId:f.userId})}catch(t){(0,l.debug)("init.js: Pulse2 init failed: "+t,y)}}])});var pulse2config = {
    "client": "leboncoin",
    "config": [
        {
            "throttle": 1,
            "dataCollector": "https://collector.schibsted.io/api/v1/track",
            "cis": "https://cis.schibsted.com/api/v1/identify"
        }
    ]
}
;